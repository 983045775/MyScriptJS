<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="HandheldFriendly" content="true"/>

  <title>WEBSOCKET Text iink</title>

  <link rel="stylesheet" href="../../dist/myscript.min.css"/>
  <link rel="stylesheet" href="../examples.css">

  <script src="https://code.jquery.com/pep/0.4.3/pep.js"></script>
  <script type="text/javascript" src="../../dist/myscript.min.js"></script>
</head>

<body>
<div>
  <nav>
    <div class="button-div">
      <button id="undo" class="nav-btn btn-fab-mini btn-lightBlue" disabled>
        <img src="../assets/img/undo.svg">
      </button>
      <button id="redo" class="nav-btn btn-fab-mini btn-lightBlue" disabled>
        <img src="../assets/img/redo.svg">
      </button>
    </div>
    <select id="language"></select>
  </nav>
  <div id="editor" touch-action="none"></div>
</div>
<script>
  var editorElement = document.getElementById('editor');

  var languageElement = document.getElementById('language');
  var undoElement = document.getElementById('undo');
  var redoElement = document.getElementById('redo');

  editorElement.addEventListener('changed', function (event) {
    undoElement.disabled = !event.detail.canUndo;
    redoElement.disabled = !event.detail.canRedo;
  });

  editorElement.addEventListener('loaded', function (evt) {
    /**
     * Retrieve the list of available recognition languages
     * @param {Object} The editor recognition parameters
     */
    var currentLanguage = evt.target.editor.configuration.recognitionParams.v4.lang;
    var res = MyScript.getAvailableLanguageList();

    if (languageElement.options.length === 0) {
      Object.keys(res.result).forEach(function (key) {
        var selected = currentLanguage === key;
        languageElement.options[languageElement.options.length] = new Option(res.result[key], key, selected, selected);
      });
    }

    /*var data = JSON.stringify({
      "xDPI": 96,
      "yDPI": 96,
      "width": 815,
      "height": 1153,
      "contentType": "Text",
      "configuration": {
        "lang": "en_US",
        "text": {},
        "export": {
          "jiix": {
            "strokes": false,
            "text": {
              "chars": false,
              "words": true
            }
          }
        }
      },
      "writeEntries": [
        {
          "strokes": [
            {
              "x": [
                67,
                72,
                73,
                73,
                73,
                74,
                77,
                80,
                84
              ],
              "y": [
                116,
                120,
                124,
                130,
                136,
                144,
                150,
                156,
                162
              ],
              "t": [
                1518538153886,
                1518538153930,
                1518538153986,
                1518538154003,
                1518538154019,
                1518538154037,
                1518538154053,
                1518538154070,
                1518538154087
              ],
              "p": [
                0.5,
                0.7469560465564757,
                0.7185264889882718,
                0.7665225987135362,
                0.7665225987135362,
                0.800160363181834,
                0.7798249238338513,
                0.7798249238338513,
                0.7880849230110567
              ]
            },
            {
              "x": [
                72,
                82,
                92,
                105,
                117,
                124
              ],
              "y": [
                152,
                151,
                149,
                146,
                142,
                139
              ],
              "t": [
                1518538154207,
                1518538154237,
                1518538154254,
                1518538154271,
                1518538154287,
                1518538154303
              ],
              "p": [
                0.5,
                0.6829846120277299,
                0.680656313242526,
                0.6347375729133047,
                0.6443441179922154,
                0.7941045496521526
              ]
            },
            {
              "x": [
                121,
                122,
                123,
                124,
                126,
                129,
                131,
                132
              ],
              "y": [
                125,
                131,
                135,
                140,
                145,
                151,
                155,
                158
              ],
              "t": [
                1518538154411,
                1518538154473,
                1518538154487,
                1518538154504,
                1518538154519,
                1518538154537,
                1518538154553,
                1518538154565
              ],
              "p": [
                0.5,
                0.7533674285440339,
                0.7185264889882718,
                0.7461846839143089,
                0.7531128489300326,
                0.7798249238338513,
                0.7292125754002905,
                0.6831899108492184
              ]
            },
            {
              "x": [
                134,
                137,
                148,
                166,
                161,
                156,
                155,
                156,
                159,
                163,
                171,
                177,
                182,
                186,
                188,
                186,
                182,
                178,
                175,
                171,
                169,
                167,
                167,
                174,
                181,
                189,
                197,
                205,
                212,
                213,
                211,
                208,
                204,
                201,
                200,
                201,
                207,
                213,
                222,
                230,
                240,
                243,
                240,
                239,
                244,
                247,
                245,
                241,
                244,
                250,
                259
              ],
              "y": [
                160,
                160,
                158,
                151,
                149,
                150,
                155,
                158,
                159,
                159,
                159,
                156,
                151,
                146,
                140,
                131,
                127,
                126,
                125,
                127,
                131,
                136,
                141,
                149,
                152,
                153,
                153,
                150,
                142,
                136,
                130,
                128,
                128,
                135,
                141,
                147,
                153,
                155,
                156,
                155,
                152,
                150,
                154,
                157,
                161,
                161,
                157,
                156,
                154,
                152,
                151
              ],
              "t": [
                1518538154660,
                1518538154672,
                1518538154688,
                1518538154738,
                1518538154772,
                1518538154805,
                1518538154838,
                1518538154859,
                1518538154871,
                1518538154888,
                1518538154904,
                1518538154929,
                1518538154937,
                1518538154956,
                1518538154972,
                1518538154988,
                1518538155005,
                1518538155022,
                1518538155039,
                1518538155055,
                1518538155072,
                1518538155087,
                1518538155105,
                1518538155122,
                1518538155138,
                1518538155155,
                1518538155172,
                1518538155188,
                1518538155205,
                1518538155222,
                1518538155237,
                1518538155255,
                1518538155272,
                1518538155305,
                1518538155321,
                1518538155339,
                1518538155355,
                1518538155372,
                1518538155389,
                1518538155405,
                1518538155422,
                1518538155439,
                1518538155506,
                1518538155522,
                1518538155555,
                1518538155572,
                1518538155621,
                1518538155638,
                1518538155671,
                1518538155689,
                1518538155705
              ],
              "p": [
                0.5,
                0.8267949192431123,
                0.5443526554581978,
                0.5605320499077553,
                0.7531128489300326,
                0.7461846839143089,
                0.7461846839143089,
                0.6831899108492184,
                0.6831899108492184,
                0.7145158745241171,
                0.7993507587287858,
                0.7798249238338513,
                0.785875329883628,
                0.774350629289587,
                0.7728798232191826,
                0.8133650328603405,
                0.7592733046045574,
                0.7185264889882718,
                0.6831899108492184,
                0.7292125754002905,
                0.7292125754002905,
                0.7531128489300326,
                0.7436746598382117,
                0.6739609561304866,
                0.7941045496521526,
                0.800160363181834,
                0.7993507587287858,
                0.8060672826037246,
                0.6739609561304866,
                0.7681880209236327,
                0.7728798232191826,
                0.7007103955941203,
                0.7145158745241171,
                0.7941045496521526,
                0.7681880209236327,
                0.7681880209236327,
                0.8053800748006557,
                0.7728798232191826,
                0.811690865715624,
                0.800160363181834,
                0.6768853685004259,
                0.7007103955941203,
                0.7436746598382117,
                0.6831899108492184,
                0.774350629289587,
                0.6761535882018319,
                0.7292125754002905,
                0.7185264889882718,
                0.7007103955941203,
                0.7728798232191826,
                0.811690865715624
              ]
            },
            {
              "x": [
                275,
                275,
                275,
                274,
                274,
                274,
                275,
                276
              ],
              "y": [
                161,
                167,
                170,
                173,
                176,
                180,
                185,
                188
              ],
              "t": [
                1518538155836,
                1518538155856,
                1518538155871,
                1518538155889,
                1518538155906,
                1518538155931,
                1518538155938,
                1518538155956
              ],
              "p": [
                0.5,
                0.7550510257216823,
                0.6761535882018319,
                0.6831899108492184,
                0.6761535882018319,
                0.7145158745241171,
                0.7461846839143089,
                0.6831899108492184
              ]
            },
            {
              "x": [
                443,
                447,
                444,
                441,
                435,
                432,
                431,
                435,
                439,
                445,
                446,
                446,
                444,
                445,
                449,
                453,
                457,
                461,
                464,
                468,
                474,
                477,
                477,
                473,
                469,
                468,
                469,
                477,
                483
              ],
              "y": [
                149,
                149,
                149,
                150,
                155,
                158,
                161,
                163,
                162,
                158,
                155,
                152,
                156,
                159,
                162,
                161,
                159,
                156,
                154,
                155,
                155,
                154,
                151,
                152,
                155,
                159,
                162,
                164,
                164
              ],
              "t": [
                1518538157471,
                1518538157491,
                1518538157524,
                1518538157541,
                1518538157557,
                1518538157574,
                1518538157591,
                1518538157624,
                1518538157642,
                1518538157658,
                1518538157674,
                1518538157706,
                1518538157741,
                1518538157758,
                1518538157791,
                1518538157807,
                1518538157825,
                1518538157841,
                1518538157859,
                1518538157930,
                1518538157958,
                1518538157975,
                1518538158009,
                1518538158025,
                1518538158042,
                1518538158058,
                1518538158075,
                1518538158091,
                1518538158106
              ],
              "p": [
                0.5,
                0.8,
                0.6761535882018319,
                0.6831899108492184,
                0.7968145931762148,
                0.7222966378316396,
                0.6831899108492184,
                0.7292125754002905,
                0.7185264889882718,
                0.7880849230110567,
                0.6831899108492184,
                0.6761535882018319,
                0.7292125754002905,
                0.6831899108492184,
                0.7436746598382117,
                0.7185264889882718,
                0.7292125754002905,
                0.7436746598382117,
                0.7007103955941203,
                0.7185264889882718,
                0.7665225987135362,
                0.6831899108492184,
                0.6761535882018319,
                0.7185264889882718,
                0.7436746598382117,
                0.7185264889882718,
                0.6831899108492184,
                0.8024894359144054,
                0.7665225987135362
              ]
            },
            {
              "x": [
                510,
                514,
                518,
                522,
                525,
                525,
                525,
                525,
                529,
                533,
                539,
                543,
                546,
                546,
                544,
                546,
                550,
                555,
                558,
                555,
                550,
                544,
                535,
                528,
                524,
                524,
                526,
                533,
                547,
                555,
                561,
                564,
                558,
                554,
                555,
                560,
                568,
                570,
                570,
                567,
                571,
                574,
                577,
                580,
                580,
                584,
                588,
                594,
                597,
                597,
                601
              ],
              "y": [
                157,
                156,
                153,
                151,
                150,
                153,
                157,
                160,
                162,
                162,
                161,
                158,
                155,
                151,
                155,
                160,
                168,
                178,
                188,
                201,
                206,
                209,
                208,
                204,
                200,
                195,
                190,
                184,
                174,
                168,
                163,
                160,
                161,
                165,
                169,
                170,
                168,
                165,
                162,
                159,
                156,
                155,
                154,
                156,
                162,
                165,
                163,
                158,
                155,
                160,
                163
              ],
              "t": [
                1518538158244,
                1518538158258,
                1518538158276,
                1518538158291,
                1518538158308,
                1518538158341,
                1518538158358,
                1518538158375,
                1518538158392,
                1518538158409,
                1518538158425,
                1518538158441,
                1518538158459,
                1518538158475,
                1518538158542,
                1518538158558,
                1518538158575,
                1518538158592,
                1518538158608,
                1518538158626,
                1518538158642,
                1518538158658,
                1518538158676,
                1518538158692,
                1518538158709,
                1518538158725,
                1518538158742,
                1518538158759,
                1518538158776,
                1518538158792,
                1518538158808,
                1518538158826,
                1518538158893,
                1518538158909,
                1518538158942,
                1518538158959,
                1518538158976,
                1518538158992,
                1518538159009,
                1518538159026,
                1518538159092,
                1518538159109,
                1518538159143,
                1518538159176,
                1518538159209,
                1518538159242,
                1518538159259,
                1518538159276,
                1518538159293,
                1518538159360,
                1518538159393
              ],
              "p": [
                0.5,
                0.796945681513107,
                0.7436746598382117,
                0.7292125754002905,
                0.6831899108492184,
                0.6761535882018319,
                0.7145158745241171,
                0.6761535882018319,
                0.7292125754002905,
                0.7145158745241171,
                0.7681880209236327,
                0.7436746598382117,
                0.7222966378316396,
                0.7145158745241171,
                0.7292125754002905,
                0.7531128489300326,
                0.8105224395454083,
                0.665629847511789,
                0.6768853685004259,
                0.6347375729133047,
                0.785875329883628,
                0.7798249238338513,
                0.811690865715624,
                0.800160363181834,
                0.7592733046045574,
                0.7436746598382117,
                0.7531128489300326,
                0.8133650328603405,
                0.5852151095557451,
                0.683772233983162,
                0.7968145931762148,
                0.7222966378316396,
                0.7681880209236327,
                0.7592733046045574,
                0.7185264889882718,
                0.7461846839143089,
                0.8024894359144054,
                0.7007103955941203,
                0.6761535882018319,
                0.7222966378316396,
                0.7436746598382117,
                0.6831899108492184,
                0.6831899108492184,
                0.7007103955941203,
                0.7665225987135362,
                0.7436746598382117,
                0.7292125754002905,
                0.7968145931762148,
                0.7222966378316396,
                0.7436746598382117,
                0.7436746598382117
              ]
            },
            {
              "x": [
                636,
                635,
                639,
                649,
                660,
                667,
                670,
                671,
                672,
                672
              ],
              "y": [
                148,
                142,
                137,
                132,
                129,
                129,
                134,
                138,
                143,
                151
              ],
              "t": [
                1518538159557,
                1518538159577,
                1518538159594,
                1518538159610,
                1518538159626,
                1518538159644,
                1518538159677,
                1518538159693,
                1518538159710,
                1518538159727
              ],
              "p": [
                0.5,
                0.7533674285440339,
                0.774350629289587,
                0.665629847511789,
                0.6623351624614819,
                0.78472787299413,
                0.763022254896924,
                0.7185264889882718,
                0.7461846839143089,
                0.7993507587287858
              ]
            },
            {
              "x": [
                673,
                673,
                675
              ],
              "y": [
                165,
                170,
                173
              ],
              "t": [
                1518538159797,
                1518538159811,
                1518538159885
              ],
              "p": [
                0.5,
                0.7763932022500211,
                0.7007103955941203
              ]
            }
          ]
        }
      ]
    });

    var xhr = new XMLHttpRequest();
    xhr.withCredentials = true;

    xhr.addEventListener("readystatechange", function () {
      if (this.readyState === this.DONE) {
        console.log(this.responseText);
      }
    });

    xhr.open("POST", "http://localhost:8897/api/v4.0/iink/batch", true);
    xhr.setRequestHeader("accept", "application/json,text/plain");
    xhr.setRequestHeader("applicationkey", "515131ab-35fa-411c-bb4d-3917e00faf60");
    xhr.setRequestHeader("hmac", "54b2ca8a-6752-469d-87dd-553bb450e9ad");
    xhr.setRequestHeader("content-type", "application/json");

    xhr.send(data);
*/
  });

  languageElement.addEventListener('change', function (e) {
    var configuration = editorElement.editor.configuration;
    //The path to the language depend of the version of API you are using.
    configuration.recognitionParams.v4.lang = e.target.value;
    editorElement.editor.configuration = configuration;
  });

  undoElement.addEventListener('click', function () {
    editorElement.editor.undo();
  });
  redoElement.addEventListener('click', function () {
    editorElement.editor.redo();
  });

  /**
   * Attach an editor to the document
   * @param {Element} The DOM element to attach the ink paper
   * @param {Object} The recognition parameters
   */
  MyScript.register(editorElement, {
    triggers: {
      exportContent: 'QUIET_PERIOD'
    },
    recognitionParams: {
      type: 'TEXT',
      protocol: 'REST',
      apiVersion: 'V4',
      server: {
        scheme: 'https',
        host: 'webdemoapi.myscript.com',
        applicationKey: '515131ab-35fa-411c-bb4d-3917e00faf60',
        hmacKey: '54b2ca8a-6752-469d-87dd-553bb450e9ad'
      }
    }
  });

  window.addEventListener('resize', function () {
    editorElement.editor.resize();
  });
</script>
</body>

</html>