<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>MyScriptJS</title>

    <link href="../../css/MySBuilder.css" rel="stylesheet" type="text/css">
    <link rel="shortcut icon" href="../../images/favicon.ico"/>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
</head>

<body bgcolor="#FFFFFF" text="#000000">
<h1>MyScriptJS Developer Guide</h1>

<p><img src="../../images/ic-shape.png" style="float:right" width="80" height="80"></p>

<h2>Shape recognition</h2>

<p>MyScript Shape can recognize a fixed set of hand drawn shapes and lines.</p>

<p style="text-align:center"><img src="../../images/shape_reco.png"></p>
<p>A shape is related to one or more primitives, which is the basic geometrical unit of a shape (a line segment, an arc, etc.). Each type of shape recognized can be described by one or more of these basic primitives. For example, a rectangle is made up of 4 line segments, a circle is a type of arc, etc.</p>
<p>The recognizer will send you a result describing the type of shape, the primitives that constitute it and information on the shape's orientation, size etc., so that it can be reconstituted geometrically. The resulting shape will be &quot;beautified&quot; to give a visually attractive geometrical shape as close as possible to the original. For example, roughly parallel lines will be made perfectly parallel, shapes that are almost touching will be connected and so on. </p>
<h3>How does Shape recognition work?</h3>

<p>The Shape recognizer uses resources describing a set of recognizable shapes, and components defining each type of shape. Then, it  sends back components in a beautified form (if needed, see <code>doBeautification</code>), describing the shape's type, which curves and line segments it uses, as well as their size and position. That way, you can reconstitute the shape as a vector object.</p>

<p>A list of limitations for Shape recognition can be found <a href="../appendices/limitations.html#shape_limitations">in
    the appendix</a>.</p>

<p>See the <a href="http://doc.myscript.com/MyScriptJS/API_Reference/index.html" target="_blank">Reference
    guide</a> for information on the mandatory and optional parameters needed for Shape recognition.</p>

<h3>Making a Shape recognition request</h3>

<p>The below example shows a Shape recognition request where the following are to be specified:</p>
<ul>
    <ul>
        <li>URL (defined by default)</li>
        <li>application key &amp; HMAC key (obtained in the <a href="http://cloud.myscript.com" target="_blank">MyScript
            Cloud Admin UI</a>)
        </li>
    </ul>
</ul>
<pre class="language-javascript">
    <code>
        &lt;!DOCTYPE html&gt;<br />
        &lt;html&gt;<br />
        &lt;head&gt;<br />
            &lt;meta&gt; charset="utf-8"&lt;/meta&gt;<br />
            &lt;title&gt;Shape - Getting started&lt;/title&gt;<br />
        &lt;/head&gt;
        &lt;body&gt;<br />
            &lt;h1&gt;Shape - Getting started&lt;/h1&gt;
            &lt;canvas id="canvas" width="400" height="300" style="background-color: lightyellow; border: 1px solid darkgoldenrod;"&gt;&lt;/canvas&gt;
            &lt;canvas id="result-canvas" width="400" height="300" style="background-color: ghostwhite; border: 1px solid darkgrey;"&gt;&lt;/canvas&gt;
        &lt;/body&gt;
        &lt;!-- CryptoJS imports --&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;lib/core-min.js&quot;&gt;&lt;/script&gt;<br />
        &lt;script type=&quot;text/javascript&quot; src=&quot;lib/x64-core-min.js&quot;&gt;&lt;/script&gt;<br />
        &lt;script type=&quot;text/javascript&quot; src=&quot;lib/sha512-min.js&quot;&gt;&lt;/script&gt;<br />
        &lt;script type=&quot;text/javascript&quot; src=&quot;lib/hmac-min.js&quot;&gt;&lt;/script&gt;<br />
        &lt;!-- Q imports --&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;lib/q.js&quot;&gt;&lt;/script&gt;<br />
        &lt;!-- HandJS imports --&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;lib/hand.minified-1.3.8.js&quot;&gt;&lt;/script&gt;<br />
        &lt;!-- MyScriptJS imports --&gt;
        &lt;script type=&quot;text/javascript&quot; src=&quot;../myscript.min.js&quot;&gt;&lt;/script&gt;<br />
        &lt;script&gt;
        (function () {
            var canvas = document.getElementById('canvas');
            var context = canvas.getContext('2d');
            var resultCanvas = document.getElementById("result-canvas");
            var resultContext = resultCanvas.getContext("2d");
            var pointerId;
            var instanceId;

            /*
            * Handle MyScript Cloud authentication keys
            */
            var applicationKey = prompt("Please enter your application key", "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx");
            var hmacKey = prompt("Please enter your HMAC key", "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx");

            /*
            * Declare an instance of MyScriptJS InkManager in order to capture digital ink
            */
            var inkManager = new MyScript.InkManager();

            /*
            * Declare an instance of MyScriptJS Shape Renderer in order to enable ink rendering
            */
            var shapeRenderer = new MyScript.ShapeRenderer();

            /*
            * Declare an instance of MyScriptJS Shape Recognizer
            */
            var shapeRecognizer = new MyScript.ShapeRecognizer();

            function doRecognition() {

                if (!inkManager.isEmpty()) {
                    shapeRecognizer.doSimpleRecognition(applicationKey, instanceId, inkManager.getStrokes(), hmacKey).then(
                        function (data) {
                            if (!instanceId) {
                                instanceId = data.getInstanceId();
                            } else if (instanceId !== data.getInstanceId()) {
                                return;
                            }

                            shapeRenderer.clear(resultContext);
                            shapeRenderer.drawRecognitionResult(inkManager.getStrokes(), data.getShapeDocument(), resultContext);
                        }
                    );
                } else {
                    shapeRenderer.clear(resultContext);
                }
            }

            /*
            * On pointer down: Start ink rendering and ink capture.
            */
            canvas.addEventListener('pointerdown', function (event) {
                if (!pointerId) {
                    pointerId = event.pointerId;
                    event.preventDefault();
                    // Start ink rendering
                    shapeRenderer.drawStart(event.offsetX, event.offsetY);
                    // Start ink capture
                    inkManager.startInkCapture(event.offsetX, event.offsetY);
                }
            }, false);

            /*
            * On pointer move: Continue ink rendering and ink capture.
            */
            canvas.addEventListener('pointermove', function (event) {
                if (pointerId === event.pointerId) {
                    event.preventDefault();
                    // Continue ink rendering
                    shapeRenderer.drawContinue(event.offsetX, event.offsetY, context);
                    // Continue ink capture
                    inkManager.continueInkCapture(event.offsetX, event.offsetY);
                }
            }, false);

            /*
            * On pointer up: Stop ink rendering and ink capture and send recognition request.
            */
            canvas.addEventListener('pointerup', function (event) {
                if (pointerId === event.pointerId) {
                    event.preventDefault();
                    // Stop ink rendering
                    shapeRenderer.drawEnd(event.offsetX, event.offsetY, context);
                    // Stop ink capture
                    inkManager.endInkCapture();
                    // Send recognition request
                    pointerId = undefined;
                    // Send recognition request
                    doRecognition();
                }
            }, false);

            /*
            * On pointer leave: Continue ink rendering and ink capture.
            */
            canvas.addEventListener('pointerleave', function (event) {
                if (pointerId === event.pointerId) {
                    event.preventDefault();
                    // Stop ink rendering
                    shapeRenderer.drawEnd(event.offsetX, event.offsetY, context);
                    // Stop ink capture
                    inkManager.endInkCapture();
                    pointerId = undefined;
                    // Send recognition request
                    doRecognition();
                }
            }, false);

        })();
        &lt;/script&gt;
    </code>
</pre>
</body>
</html>
