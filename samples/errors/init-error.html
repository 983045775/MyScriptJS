<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>Init Error</title>
    <!-- Live reload with webpack -->
    <script src="http://localhost:8080/webpack-dev-server.js"></script>
    <script type="text/javascript" src="/node_modules/pepjs/dist/pep.min.js"></script>
    <!-- Including MyScriptJS with style and JS -->
    <link rel="stylesheet" href="/dist/myscript.min.css"/>
    <script src="/dist/myscript.min.js"></script>
    <link rel="stylesheet" href="../samples.css">
    <style>
        .serverunreachable {
            position: absolute;
            height: 100%;
            width: 100%;
            top: 0;
            left: 0;
            display: inline-block;
            vertical-align: top;
            text-align: center;
            color: #1A9FFF;
        }

        .error-msg {
            position: absolute;
            margin: auto;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 200px;
            height: 200px;
            border-radius: 3px;
            z-index: 1;
        }

    </style>
</head>
<body touch-action="none">
<div id="result"></div>
<div>
    <div class="serverunreachable" hidden>
        <div class="error-msg" hidden><p class="detail-msg">MyScript recognition server is not reachable. Please reload once you are
            connected</p><img
                src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjEyOHB4IiBoZWlnaHQ9IjEyOHB4IiB2aWV3Qm94PSIwIDAgNjEyIDYxMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNjEyIDYxMjsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8Zz4KCTxnIGlkPSJjbG91ZC1vZmYiPgoJCTxwYXRoIGQ9Ik00OTQuNywyMjkuNWMtMTcuODUxLTg2LjctOTQuMzUxLTE1My0xODguNy0xNTNjLTM4LjI1LDAtNzMuOTUsMTAuMi0xMDIsMzAuNmwzOC4yNSwzOC4yNSAgICBjMTcuODUtMTIuNzUsNDAuOC0xNy44NSw2My43NS0xNy44NWM3Ni41LDAsMTQwLjI1LDYzLjc1LDE0MC4yNSwxNDAuMjV2MTIuNzVoMzguMjVjNDMuMzUsMCw3Ni41LDMzLjE1LDc2LjUsNzYuNSAgICBjMCwyOC4wNS0xNS4zLDUzLjU1LTQwLjgsNjYuM2wzOC4yNSwzOC4yNUM1OTEuNiw0MzguNiw2MTIsNDAwLjM1LDYxMiwzNTdDNjEyLDI5MC43LDU1OC40NSwyMzQuNiw0OTQuNywyMjkuNXogTTc2LjUsMTA5LjY1ICAgIGw3MS40LDY4Ljg1QzY2LjMsMTgzLjYsMCwyNDkuOSwwLDMzMS41YzAsODQuMTUsNjguODUsMTUzLDE1MywxNTNoMjk4LjM1bDUxLDUxbDMzLjE1LTMzLjE1TDEwOS42NSw3Ni41TDc2LjUsMTA5LjY1eiAgICAgTTE5Ni4zNSwyMjkuNWwyMDQsMjA0SDE1M2MtNTYuMSwwLTEwMi00NS45LTEwMi0xMDJjMC01Ni4xLDQ1LjktMTAyLDEwMi0xMDJIMTk2LjM1eiIgZmlsbD0iIzFhOWZmZiIvPgoJPC9nPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo="/>
        </div>
    </div>
    <div id="inkPaper"></div>
</div>
<script>
  var inkPaperElement = document.getElementById('inkPaper');

  inkPaperElement.addEventListener('error', function (evt) {
    if (evt.detail && evt.detail.recoverable === false) {
      if(evt.detail.serverMessage && evt.detail.serverMessage.error && evt.detail.serverMessage.error.result && evt.detail.serverMessage.error.result.error && (evt.detail.serverMessage.error.result.error === 'InvalidApplicationKeyException' || evt.detail.serverMessage.error.result.error === "InvalidHMACSignatureException")){
        document.querySelector('.detail-msg').innerText = 'Application credentials are invalid. Please check or regenerate your application key and hmackey.';
      }
      document.querySelector('.serverunreachable').style['z-index'] = 30;
      document.querySelector('.serverunreachable').removeAttribute('hidden');
      document.querySelector('.error-msg').style['z-index'] = 30;
      document.querySelector('.error-msg').removeAttribute('hidden');
      document.querySelector('#inkPaper').style['opacity'] = 0.6;
    } else {
      document.querySelector('#result').innerText = JSON.stringify(evt.detail);
    }
  });

  /**
   * Attach an inkPaper to the document
   * @param {Element} The DOM element to attach the ink paper
   * @param {Object} The recognition parameters
   */
  MyScript.register(inkPaperElement, {
    recognitionParams: {
      type: 'MATH',
      protocol: 'WEBSOCKET',
      server: {
        host: 'unreachablehost.com',
        applicationKey: '8e4c16b2-0fde-409d-91d5-df7321644013',
        hmacKey: '5235ad4f-7046-437a-8b94-7dcbbcb39d32',
      },
      mathParameter: {
        resultTypes: ['LATEX']
      }
    }
  });

  window.addEventListener('resize', function () {
    inkPaperElement['data-myscript-ink-paper'].resize();
  });

</script>
</body>
</html>
